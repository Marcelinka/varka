# README VARKA

## Файловая структура темы (`varka25/`)
`css/` Папка для стилей из библиотек (*подключаются* в `functions.php`)  
`fonts/` Папка для шрифтов (*подключаются* в `src/css/common/fonts.css`)  
`img/` Папка для изображений (в основном `svg`)  
`includes/` Папка для php файлов (*подключаются* в `functions.php`)  
`js/` Папка для javascript файлов с библиотек (*подключаются* в `functions.php`)  
`src/` Папка для исходных файлов css и js (*собираются* gulp в 2 файла, которые подключаются в `functions.php`)  
`template-parts/` Папка для шаблонов html  
`woocommerce/` Папка для шаблонов woocommerce  
`/` Файлы шаблонов

***

## Шаблоны
### Стандартные шаблоны

**Общее**  
`header.php` Шапка сайта  
`footer.php` Подвал сайта  

**Статические страницы**  
`front-page.php` Главная страница  
`shop.php` Страница Магазин  
`wishlist.php` Страница Wishlist  
`personal.php` Страница с текстом по согласию обработки персональных данных

**Страницы постов**  
`home.php` Страница со всеми записями  
`category.php` Страница со всеми записями (доп.шаблон для категорий)  
`template-parts/blog-header.php` Шапка блога  
`template-parts/blog-posts.php` Записи  
`single.php` Страница одной записи

**Страницы кастомных типов**  
`archive-review.php` Страница со всеми отзывами  
`archive-stock.php` Страница со всеми акциями  
`single-stock.php` Страница одной акции

`404.php` Страницы с ошибкой (Страница не найдена)  
`index.php` Стандартный шаблон (туда ведет страница Контакты)

### Шаблоны Woocommerce

**Каталог**  
`loop/loop-start.php` Обертка товаров (начало)  
`archive-product.php` Шапка и сайдбар  
`content-product.php` Один товар  
`loop/price.php` Цена  
`loop/pagination.php` Пагинация  
`loop/loop-end.php` Обертка товаров (конец)  

**Товар**  
`single-product.php` Шапка  
`content-single-product.php` Контент  
`single-product/meta.php` Артикул  
`single-product/add-to-cart/variable.php` Вариации  
`single-product/add-to-cart/variation-add-to-cart-button.php` Убираем кнопку Добавить в корзину в вариативном товаре  
`single-product/add-to-cart/simple.php` Убираем кнопку Добавить в корзину в простом товаре

***

## Includes

`globals`  
Какие-то общие изменения  
- Создает страницу глобальных настроек  
- Отключает шапку wordpress  

`image-sizes`  
Новые размеры изображений

`register_post_type_stock`  
- Создает тип поста `stock`, *Акции*  
- Создает таксономию для акций `stock_type`, *Типы акций*  

`register_post_type_review`  
Создает тип поста `review`, *Отзыв*

`ajax-news`  
- Регистрирует хук на ajax `load_news`  
- Формирует html с 6 новостями для подгрузки на странице Блог

`ajax-review`  
- Регистрирует хук на ajax `load_reviews`  
- Формирует html со всеми отзывами для замены на странице Отзывы

`hooks-woocommerce`  
- Удаляет ненужные хуки  
- Добавляет блок с затемнением и надписью Подробнее на товар в Каталоге  
- Добавляет обертку для хлебных крошек (для стилизации)  
- Добавляет код кнопки Wishlist на странице товара

`filters`  
Добавляет функцию `woo_filters`, которая генерирует шорткоды с br-filters для сайдбара в каталоге

`wishlist-button-hook`  
Добавляет фильтр, добавляющий цифру с количеством элементов в вишлисте к пункту меню Wishlist

`order-mail`  
- Регистрирует хук на ajax `mail_order`  
- Формирует файл pdf с заказом  
- Получает почту с глобальных настроек  
- Отправляет письмо на почту, прикрепляя файл  
- Удаляет файл

***

## Исходные файлы
### CSS
`common/` **Общее**  
`custom-media-queries` Кастомные медиа запросы  
`custom-properties` Кастомные переменные (цвета)  
`fonts` Подключение шрифтов  
`other` Общие стили, обнуление, анимации, кнопки  
`header` Шапка, мобильное меню  
`footer` Подвал, форма Обратный звонок

`frontpage/` **Главная**  
`stock` Блок главной акций и превью акций  
`post` Превью последних постов (видео, советы, статья и рецепт)  
`other` Все остальное

`catalog/` **Каталог**  
`header` Категории и сайдбар  
`content` Товары

`post/` **Посты**  
`header` Прикрепленный пост, категории  
`content` Посты

`style.css` include всех css файлов  
`stock.css` Страницы Все акции и Одна акция  
`review.css` Страница Все отзывы, форма Добавить отзыв  
`shop.css` Страница Магазин  
`wishlist.css` Страница WIshlist, форма Отправить заказ

### JS
`entry`  
- require всех необходимых файлов  
- глобальные переменные для lockScroll, unlockScroll  
- модальные окна Доставка и оплата, Юридическая информация, Обратный звонок  
- выпадающее меню с категориями  
- форма с отзывами, если файл загружен, меняет надпись на Загружено  
- код для вариаций woocommerce

`smoothScroll`  
Плавный скролл до якорей

`lockScroll`  
Функции для блокировки скролла на body

`carouselSetup`  
Запуск карусели на мобильной версии Магазина

`emailProcess`  
Обработка почтовых событий (wpcf7)  
- На сабмит меняет надпись на кнопке на Отправляю.. и блокирует  
- При событии invalid меняет надпись на кнопке обратно и разблокирует  
- При событии spam (recaptcha не проставлена) делает то же, что и при invalid  
- При событии mailsent меняет надпись на Отправлено и блокирует  
- При событии mailfailed делает alert, что Что-то пошло не так

`menu-and-sidebar-mobile`  
Выезд мобильного меню и сайдбара

`newsLoad`  
Отправляет ajax запрос, чтобы подгрузить новости

`reviewsLoad`  
Отправляет ajax запрос, чтобы выгрузить отзывы

`pdfFileBody` формирует body для pdf файла из localStorage  
`makePdfFile` формирует pdf файл товаров с вишлиста

`wishlist`  
Vue элементы вишлиста  
- Главный элемент на странице Вишлист, отображает список товаров, удаляет отдельные товары,
открывает модальное окно с формой, отправляет ajax запрос с данными для письма, реагирует на
почтовые события, формирует pdf файл для скачивания клиентом  
- Элемент на странице товара с кнопкой WIshlist, компонент отображает кнопку и отслеживает, есть ли
товар в списке, а также формирует event для удаления или добавления элемента в localStorage  
- Элемент, отслеживающий количество элементов в листе